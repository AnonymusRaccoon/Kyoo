<div id="root">
  <div class="player">
    <video id="player" poster="backdrop/{{this.item.showSlug}}" autoplay muted (click)="tooglePlayback()">
      <source src="/api/video/{{this.item.link}}" />
      <source src="/api/video/{{this.item.link}}/stream" type="video/mp4" />
    </video>
  </div>

  <div id="loadIndicator">
    <div class="spinner-border align-self-center" role="status"></div>
  </div>

  <div id="hover">
    <div class="back">
      <a mat-icon-button data-toggle="tooltip" data-placement="bottom" title="Back" href="/show/{{this.item.showSlug}}" routerLink="/show/{{this.item.showSlug}}">
        <mat-icon>arrow_back</mat-icon>
      </a>
      <h5>{{this.item.showTitle}}</h5>
    </div>

    <div class="controller container-fluid" id="controller">
      <div class="img d-none d-sm-block">
        <img src="poster/{{this.item.showSlug}}" />
      </div>
      <div class="content">
        <h3>S{{this.item.seasonNumber}}:E{{this.item.episodeNumber}} - {{this.item.title}}</h3>

        <div id="progress-bar">
          <div class="seek-bar">
            <div id="buffered"></div>
            <div id="progress"></div>
          </div>
          <div id="thumb"><div></div></div>
        </div>

        <div class="buttons">
          <div class="left">
            <a *ngIf="this.item.previousEpisode" mat-icon-button data-toggle="tooltip" data-placement="top" title="Previous" routerLink="/watch/{{this.item.previousEpisode}}" href="/watch/{{this.item.previousEpisode}}" queryParamsHandling="merge">
              <mat-icon>skip_previous</mat-icon>
            </a>
            <button mat-icon-button data-toggle="tooltip" data-placement="top" title="Play" id="play" (click)="tooglePlayback()">
              <mat-icon>{{this.playIcon}}</mat-icon>
            </button>
            <a mat-icon-button id="nextBtn" *ngIf="this.item.nextEpisode" routerLink="/watch/{{this.item.nextEpisode.link}}" href="/watch/{{this.item.nextEpisode.link}}" queryParamsHandling="merge">
              <mat-icon>skip_next</mat-icon>

              <div id="next">
                <div id="main">
                  <img src="{{this.item.nextEpisode.thumb}}" />
                </div>
                <div id="overview">
                  <h6>S{{this.item.nextEpisode.seasonNumber}}:E{{this.item.nextEpisode.episodeNumber}} - {{this.item.nextEpisode.title}}</h6>
                  <p>{{this.item.nextEpisode.overview}}</p>
                </div>
              </div>
            </a>
            <div id="volume">
              <button mat-icon-button data-toggle="tooltip" data-placement="top" title="Volume" (click)="toogleMute()">
                <mat-icon>{{this.volumeIcon}}</mat-icon>
              </button>

              <mat-slider [value]="volume" (input)="changeVolume($event.value)"></mat-slider>
            </div>
            <p *ngIf="this.maxHours; else elseBlock">{{this.hours | number: '2.0-0'}}:{{this.minutes | number: '2.0-0'}}:{{this.seconds | number: '2.0-0'}} / {{this.maxHours | number: '2.0-0'}}:{{this.maxMinutes | number: '2.0-0'}}:{{this.maxSeconds | number: '2.0-0'}}</p>
            <ng-template #elseBlock><p>{{this.minutes | number: '2.0-0'}}:{{this.seconds | number: '2.0-0'}} / {{this.maxMinutes | number: '2.0-0'}}:{{this.maxSeconds | number: '2.0-0'}}</p></ng-template>
          </div>
          <div class="right">
            <button *ngIf="this.item.audios.length > 0" mat-icon-button data-toggle="tooltip" data-placement="top" title="Select audio track">
              <mat-icon>music_note</mat-icon>
            </button>
            <button *ngIf="this.item.subtitles.length > 0" mat-icon-button [matMenuTriggerFor]="subtitles" data-toggle="tooltip" data-placement="top" title="Select subtitle track">
              <mat-icon>closed_caption</mat-icon>
            </button>
            <button mat-icon-button data-toggle="tooltip" data-placement="top" title="Cast">
              <mat-icon>cast</mat-icon>
            </button>
            <button mat-icon-button data-toggle="tooltip" data-placement="top" title="Settings">
              <mat-icon>settings</mat-icon>
            </button>
            <button mat-icon-button data-toggle="tooltip" data-placement="top" title="Fullscreen" id="fullscreen" (click)="fullscreen()">
              <mat-icon>{{fullscreenIcon}}</mat-icon>
            </button>
          </div>
        </div>
      </div>

      <mat-menu #subtitles="matMenu">
        <ng-template matMenuContent>
          <button [ngClass]="{'selected': this.selectedSubtitle == null}" mat-menu-item (click)="selectSubtitle(null)">
            <span>None</span>
          </button>

          <div *ngFor="let subtitle of this.item.subtitles">
            <button [ngClass]="{'selected': this.selectedSubtitle == subtitle}" mat-menu-item *ngIf="subtitle.codec == 'ass'; else elseBlock" (click)="selectSubtitle(subtitle)">
              <span>{{subtitle.displayName}}</span>
            </button>

            <ng-template #elseBlock>
              <button mat-menu-item disabled>
                <span>{{subtitle.displayName}} ({{subtitle.codec}})</span>
              </button>
            </ng-template>
          </div>
        </ng-template>
      </mat-menu>
    </div>
  </div>
</div>
